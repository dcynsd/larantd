(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e7a663d"],{"61e9":function(e,t,a){"use strict";a("4160"),a("b0c0"),a("498a"),a("159b");var r=a("ade3"),n=a("5530"),s=a("2ef0e"),i=a.n(s),o=a("b775");function d(e,t){return Object(o["b"])({url:"/".concat(e,"/batch"),method:"delete",data:t})}t["a"]=function(e){var t=e.getList,a=e.add,s=e.update;return{provide:function(){return{handleFilter:this.handleFilter,handleCreate:this.handleCreate,toggleAdvanced:this.toggleAdvanced,resetSearchForm:this.resetSearchForm,batchDestroy:this.batchDestroy,handleRefresh:this.handleRefresh}},data:function(){var e=this;return{resourceName:"",visible:!1,confirmLoading:!1,mdl:null,advanced:!1,queryParam:{},options:{},meta:{},loadData:function(a){return t(Object.assign({},a,e.queryParam)).then((function(t){return e.meta=t.data.meta,t.data}))},selectedRowKeys:[],selectedRows:[]}},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange,getCheckboxProps:this.getCheckboxProps}}},watch:{$route:{handler:function(){this.setFormValueFromQuery()},immediate:!0}},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},getCheckboxProps:function(e){return{props:{name:e.name}}},batchDestroy:function(){var e=this;this.resourceName?0!==this.selectedRowKeys.length?this.$confirm({title:"你确定要批量删除数据？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){return d(e.resourceName,{ids:e.selectedRowKeys}).then((function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.selectedRows=e.$refs.table.refresh(!0)})).catch((function(){e.$message.error("删除失败")}))}}):this.$message.error("请选择"):this.$message.error("请配置资源名称")},toggleAdvanced:function(){this.advanced=!this.advanced},handleFilter:function(){var e={};i.a.forEach(this.queryParam,(function(t,a){"string"===typeof t&&(t=t.trim()),""!==t&&void 0!==t&&(e[a]=t)})),this.$router.push({path:this.$route.path,query:e})},setFormValueFromQuery:function(){var e=this,t=this.$route.query;i.a.forEach(t,(function(a,r){a=t[r],e.$set(e.queryParam,r,a)})),this.$nextTick((function(){e.$refs.table.refresh(!0)}))},handleRefresh:function(){this.$refs.table.refresh()},resetSearchForm:function(){this.queryParam={},this.$router.push({path:this.$route.path})},handleCreate:function(){this.mdl=null,this.visible=!0},handleEdit:function(e){this.visible=!0,this.mdl=Object(n["a"])({},e)},handleCancel:function(){this.visible=!1;var e=this.$refs.createModal.form;e.resetFields()},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(n,o){n?e.confirmLoading=!1:o.id>0?s(o.id,o).then((function(){e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.$refs.table.refresh(),e.$message.success("修改成功")})).catch((function(a){var n=a.response.data,s=n.code,d=n.error;422===s&&i.a.forEach(d,(function(e,a){t.setFields(Object(r["a"])({},a,{value:o[a],errors:[{message:e[0],field:a}]}))})),e.confirmLoading=!1})):a(o).then((function(){e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.$refs.table.refresh(),e.$message.success("新增成功")})).catch((function(a){var n=a.response.data,s=n.code,d=n.error;422===s&&i.a.forEach(d,(function(e,a){t.setFields(Object(r["a"])({},a,{value:o[a],errors:[{message:e[0],field:a}]}))})),e.confirmLoading=!1}))}))}}}}},b937:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("page-filter",{attrs:{"query-param":e.queryParam,advanced:e.advanced,filters:e.filters}}),a("s-table",{ref:"table",attrs:{"row-key":"id",columns:e.columns,data:e.loadData},scopedSlots:e._u([{key:"expandedRowRender",fn:function(t){return a("div",{staticStyle:{margin:"0"}},[a("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},[a("a-col",{attrs:{lg:2,md:24}},[a("span",[e._v("角色：")])]),e._l(t.roles,(function(t){return a("a-col",{key:t.id,style:{marginBottom:"12px",height:"23px"},attrs:{span:2}},[a("a-tag",{attrs:{color:"cyan"}},[e._v(e._s(t.name))])],1)}))],2),a("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},[a("a-col",{attrs:{lg:2,md:24}},[a("span",[e._v("权限：")])]),e._l(t.permissions,(function(t){return a("a-col",{key:t.id,style:{marginBottom:"12px",height:"23px"},attrs:{span:2}},[a("a-tag",{attrs:{color:"cyan"}},[e._v(e._s(t.name))])],1)}))],2)],1)}},{key:"avatar",fn:function(e,t){return a("span",{directives:[{name:"viewer",rawName:"v-viewer"}]},[a("a-avatar",{attrs:{src:t.full_avatar}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[1===r.id?a("a",{attrs:{disabled:""}},[e._v("禁止操作")]):a("span",[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("row-destroy",{attrs:{id:r.id,resource:e.resourceName},on:{ok:e.handleFilter}})],1)])}}])}),a("create-form",{ref:"createModal",attrs:{visible:e.visible,loading:e.confirmLoading,model:e.mdl},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)],1)},n=[],s=(a("4de4"),a("5e30")),i=a("61e9"),o=a("4a68"),d=new i["a"]({getList:s["c"],add:s["a"],update:s["d"]}),c={name:"UserList",mixins:[d],components:{CreateForm:o["default"]},data:function(){return{resourceName:"admin-users",columns:[{title:"ID",dataIndex:"id"},{title:"名称",dataIndex:"name"},{title:"账号",dataIndex:"username"},{title:"头像",dataIndex:"avatar",scopedSlots:{customRender:"avatar"}},{title:"创建时间",dataIndex:"created_at"},{title:"更新时间",dataIndex:"updated_at"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],filters:[{field:"name",advanced:!1,label:"名称",type:"input"},{field:"username",advanced:!1,label:"账号",type:"input"}],expandedRowKeys:[]}},methods:{handleExpand:function(e,t){e?this.expandedRowKeys.push(t.id):this.expandedRowKeys=this.expandedRowKeys.filter((function(e){return t.id!==e}))}}},l=c,u=a("2877"),h=Object(u["a"])(l,r,n,!1,null,null,null);t["default"]=h.exports}}]);